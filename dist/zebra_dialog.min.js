!function(D){"use strict";D.Zebra_Dialog=function(){var p,u,b={animation_speed_hide:250,animation_speed_show:0,auto_close:!(this.version="3.0.5"),auto_focus_button:!0,buttons:!0,center_buttons:!1,custom_class:!1,default_value:"",disable_page_scrolling:!0,height:0,keyboard:!0,margin:0,max_height:0,max_width:450,message:"",modal:!0,backdrop_close:!0,backdrop_opacity:".9",position:"center",reposition_speed:500,show_close_button:!0,source:!1,title:"",type:"information",vcenter_short_message:!0,width:0,onClose:null},m=this,_={},h=!1,f=!1,y=function(){var t,e=D(window).width(),o=D(window).height(),i=m.dialog.outerWidth(),s=m.dialog.outerHeight(),a=e<768,n=0,r=0;m.dialog_left=undefined,m.dialog_top=undefined,(t=(m.settings.margin+"").match(/^([0-9]+)(\%)?$/))&&(undefined!==t[2]?(n=parseInt(e*parseInt(t[1],10)/100,10),r=parseInt(o*parseInt(t[1],10)/100,10)):n=r=parseInt(t[1],10),isNaN(n)&&(n=r=0)),t={left:n,top:r,right:e-n-i,bottom:o-r-s,center:(e-i)/2,middle:(o-s)/2},D.isArray(m.settings.position)&&2===m.settings.position.length&&"string"==typeof m.settings.position[0]&&m.settings.position[0].match(/^(left|right|center)[\s0-9\+\-]*$/)&&"string"==typeof m.settings.position[1]&&m.settings.position[1].match(/^(top|bottom|middle|center)[\s0-9\+\-]*$/)&&(m.settings.position[0]=m.settings.position[0].toLowerCase(),m.settings.position[1]=m.settings.position[1].toLowerCase(),"center"===m.settings.position[1]&&(m.settings.position[1]="middle"),D.each(t,function(t,e){for(var o,i,s=0;s<2;s++)(o=(i=a?m.settings.position[s].replace(/[0-9\+\-\s]/g,""):m.settings.position[s]).replace(t,e))!==i&&(0===s?m.dialog_left=d(o):m.dialog_top=d(o))})),undefined!==m.dialog_left&&undefined!==m.dialog_top||(m.dialog_left=t.center,m.dialog_top=t.middle),m.dialog_top<r&&(m.dialog_top=r),o-2*r<s+r?m.body.css("height",o-2*r-(D(".ZebraDialog_Title",m.dialog).length?D(".ZebraDialog_Title",m.dialog).outerHeight():0)-(D(".ZebraDialog_Buttons",m.dialog).length?D(".ZebraDialog_Buttons",m.dialog).outerHeight():0)-(parseFloat(m.body.css("marginTop"))||0)-(parseFloat(m.body.css("marginBottom"))||0)-(parseFloat(m.body.css("paddingTop"))||0)-(parseFloat(m.body.css("paddingBottom"))||0)-(parseFloat(m.body.css("borderTopWidth"))||0)-(parseFloat(m.body.css("borderBottomWidth"))||0)):f&&m.body.css("height",m.dialog.height()-(D(".ZebraDialog_Title",m.dialog).length?D(".ZebraDialog_Title",m.dialog).outerHeight():0)-(D(".ZebraDialog_Buttons",m.dialog).length?D(".ZebraDialog_Buttons",m.dialog).outerHeight():0)-(parseFloat(m.body.css("marginTop"))||0)-(parseFloat(m.body.css("marginBottom"))||0)-(parseFloat(m.body.css("paddingTop"))||0)-(parseFloat(m.body.css("paddingBottom"))||0)-(parseFloat(m.body.css("borderTopWidth"))||0)-(parseFloat(m.body.css("borderBottomWidth"))||0)),m.iframe&&m.body.css("overflow","hidden"),m.settings.vcenter_short_message&&(e=(n=m.body.find("div:first")).height())<(i=m.body.height())&&n.css("padding-top",(i-e)/2),"boolean"==typeof arguments[0]&&!1===arguments[0]||0===m.settings.reposition_speed?m.dialog.css({left:m.dialog_left,top:m.dialog_top,visibility:"visible",opacity:0}).animate({opacity:"1"},m.settings.animation_speed_show):(m.dialog.stop(!0),m.dialog.css("visibility","visible").animate({left:m.dialog_left,top:m.dialog_top},m.settings.reposition_speed)),undefined===p&&(!1!==m.settings.auto_focus_button?m.dialog.find("a[class^=ZebraDialog_Button]").eq(!0===m.settings.auto_focus_button?0:m.settings.auto_focus_button).focus():m.body.attr("tabindex",1).focus().removeAttr("tabindex"))},v=function(){switch(m.settings.type){case"confirmation":case"error":case"information":case"question":case"warning":case"prompt":return m.settings.type.charAt(0).toUpperCase()+m.settings.type.slice(1).toLowerCase();default:return!1}},d=function(t){var e=0;for(t=t.replace(/\s/g,"").match(/[+\-]?([0-9\.\s]+)/g)||[];t.length;)e+=parseFloat(t.shift());return e};return m.settings={},"string"==typeof arguments[0]&&(_.message=arguments[0]),"object"!=typeof arguments[0]&&"object"!=typeof arguments[1]||(_=D.extend(_,"object"==typeof arguments[0]?arguments[0]:arguments[1])),m.init=function(){var e,o,t,i,s,a,n,r,d,l,g=D("body"),c=0;if(m.settings=D.extend({},b,_),D(".ZebraDialog").each(function(){var t=parseInt(D(this).css("zIndex"),10);t&&c<t&&(c=t)}),m.settings.modal&&(m.backdrop=D("<div>",{"class":"ZebraDialogBackdrop"+(m.settings.custom_class?" "+m.settings.custom_class:"")}).css({position:"fixed",left:0,top:0,opacity:m.settings.backdrop_opacity+""}),0<c&&(m.backdrop.css("zIndex",c+1),D(".ZebraDialogBackdrop").each(function(){var t=D(this);t.data("ZebraDialog_opacity")||t.data("ZebraDialog_opacity",t.css("opacity")).css("opacity",0)}),D(".ZebraDialog").each(function(){D(this).data("ZebraDialog_MuteESC",!0)})),m.settings.backdrop_close&&m.backdrop.on("click",function(){m.close()}),m.backdrop.appendTo(g),m.settings.disable_page_scrolling&&window.innerWidth>document.body.clientWidth&&!g.hasClass("ZebraDialog_NoScroll")&&g.data("ZebraDialog_vScroll",window.pageYOffset).css({right:(r=D("<div>").css({visibility:"hidden",overflow:"scroll",msOverflowStyle:"scrollbar"}).appendTo(D("body")),d=D("<div>").appendTo(r),l=r.outerWidth()-d.outerWidth(),r.remove(),d.remove(),l),top:-1*D(window).scrollTop()}).addClass("ZebraDialog_NoScroll")),m.dialog=D("<div>",{"class":"ZebraDialog"+(m.settings.custom_class?" "+m.settings.custom_class:"")+(m.settings.modal?"":" ZebraDialog_NotModal")+(!1!==v()?" ZebraDialog_Icon ZebraDialog_"+v():"")}).css({position:"fixed",left:0,top:0,visibility:"hidden"}),0<c&&m.dialog.css("zIndex",c+1),u=Math.floor(9999999*Math.random()),(r=(m.settings.width+"").match(/^([0-9]+)(\%)?$/))&&(r=undefined!==r[2]?parseInt(Math.max(document.documentElement.clientWidth,window.innerWidth||0)*parseInt(r[1],10)/100,10):parseInt(r[1],10),!isNaN(r)&&0<r&&m.dialog.css("width",r)),(isNaN(r)||0===r)&&(r=(m.settings.max_width+"").match(/^([0-9]+)(\%)?$/))&&(r=undefined!==r[2]?parseInt(Math.max(document.documentElement.clientWidth,window.innerWidth||0)*parseInt(r[1],10)/100,10):parseInt(r[1],10),!isNaN(r)&&0<r&&m.dialog.css("max-width",r)),(r=(m.settings.height+"").match(/^([0-9]+)(\%)?$/))&&(r=undefined!==r[2]?parseInt(Math.max(document.documentElement.clientHeight,window.innerHeight||0)*parseInt(r[1],10)/100,10):parseInt(r[1],10),!isNaN(r)&&0<r&&(m.dialog.css("height",r),f=!0)),(isNaN(r)||0===r)&&(r=(m.settings.max_height+"").match(/^([0-9]+)(\%)?$/))&&(r=undefined!==r[2]?parseInt(Math.max(document.documentElement.clientHeight,window.innerHeight||0)*parseInt(r[1],10)/100,10):parseInt(r[1],10),!isNaN(r)&&0<r&&(m.dialog.css("max-height",r),f=!0)),m.settings.title?a=D("<h3>",{"class":"ZebraDialog_Title"}).html(m.settings.title).appendTo(m.dialog):m.dialog.addClass("ZebraDialog_NoTitle"),undefined!==m.settings.source.iframe&&(m.settings.vcenter_short_message=!1),m.body=D("<div>",{"class":"ZebraDialog_Body"}),"prompt"===m.settings.type&&(m.settings.message+='<input type="text" name="ZebraDialog_Prompt_Input" value="'+m.settings.default_value+'" class="ZebraDialog_Prompt_Input">'),m.settings.vcenter_short_message?D("<div>").html(m.settings.message).appendTo(m.body):m.body.html(m.settings.message),"prompt"===m.settings.type&&(m.settings.message=D(".ZebraDialog_Prompt_Input",m.body),D(".ZebraDialog_Prompt_Input",m.body).on("keypress",function(t){13===t.keyCode&&(h?h.trigger("click"):m.close(!0,this.value))})),m.settings.source&&"object"==typeof m.settings.source)for(n in o=m.settings.vcenter_short_message?D("div:first",m.body):m.body,m.settings.source)switch(n){case"ajax":t="string"==typeof m.settings.source[n]?{url:m.settings.source[n]}:m.settings.source[n],s=D("<div>").attr("class","ZebraDialog_Spinner").appendTo(o),t.success=function(t){s.remove(),o.append(t),y(!1)},D.ajax(t);break;case"iframe":t=D.extend({width:"100%",height:"100%",marginheight:"0",marginwidth:"0",frameborder:"0"},"string"==typeof m.settings.source[n]?{src:m.settings.source[n]}:m.settings.source[n]),m.iframe=D("<iframe>").attr(t).on("load",function(){D(".ZebraDialog_Spinner",m.body).remove()}),m.body.append(D("<div>").addClass("ZebraDialog_Spinner ZebraDialog_iFrame")),o.append(m.iframe);break;case"inline":o.append(m.settings.source[n])}return m.body.appendTo(m.dialog),(d=function(){if(!0!==m.settings.buttons&&!D.isArray(m.settings.buttons))return!1;if(!0===m.settings.buttons)switch(m.settings.type){case"question":case"warning":case"prompt":m.settings.buttons=["Ok","Cancel"];break;default:m.settings.buttons=["Ok"]}return m.settings.buttons}())?(e=D("<div>",{"class":"ZebraDialog_Buttons"}).appendTo(m.dialog),D.each(d,function(t,o){t=D("<a>",{href:"javascript:void(0)","class":"ZebraDialog_Button_"+t+(undefined!==o.custom_class&&""!==o.custom_class.toString().trim()?" "+o.custom_class:"")});undefined!==o.caption?t.html(o.caption):t.html(o),t.on("click",function(){var t=!0,e="prompt"===m.settings.type&&D(".ZebraDialog_Prompt_Input",m.body).length?D(".ZebraDialog_Prompt_Input",m.body).val():undefined;!1!==(t=undefined!==o.callback?o.callback(m.dialog,e):t)&&m.close(undefined!==o.caption?o.caption:o,e)}),t.appendTo(e),undefined!==o.default_confirmation&&o.default_confirmation&&(h=t)}),m.settings.center_buttons&&e.addClass("ZebraDialog_Buttons_Centered")):m.dialog.addClass("ZebraDialog_NoButtons"),m.dialog.appendTo(g),m.settings.show_close_button?D('<a href="javascript:void(0)" class="ZebraDialog_Close">&times;</a>').on("click",function(t){t.preventDefault(),m.close()}).appendTo(a||m.body):m.dialog.addClass("ZebraDialog_NoCloseButton"),D(window).on("resize.ZebraDialog_"+u,function(){clearTimeout(p),p=setTimeout(function(){y()},100)}),m.settings.keyboard&&D(document).on("keyup.ZebraDialog_"+u,function(t){if(!m.dialog.data("ZebraDialog_MuteESC"))return 27===t.which&&m.close(),!0}),!1!==m.settings.auto_close&&(m.dialog.on("click",function(){clearTimeout(m.timeout),m.close()}),m.timeout=setTimeout(m.close,m.settings.auto_close)),y(!1),"prompt"===m.settings.type&&(D(".ZebraDialog_Prompt_Input",m.body).focus(),""!==m.settings.default_value&&(m.settings.message.get(0).setSelectionRange?(i=2*m.settings.default_value.length,setTimeout(function(){m.settings.message.get(0).setSelectionRange(i,i)},1)):m.settings.message.val(m.settings.default_value))),m},m.close=function(t,e){var o=m.settings.animation_speed_hide,i=D(".ZebraDialogBackdrop"),s=D(".ZebraDialog"),a=D("body"),n=i.length;D(document).off(".ZebraDialog_"+u),D(window).off(".ZebraDialog_"+u),m.settings.modal&&m.backdrop&&(1<n&&D(i[n-1]).is(m.backdrop)?((i=D(i[n-2])).css("opacity",i.data("ZebraDialog_opacity")).removeData("ZebraDialog_opacity"),o=0,D(s[n-2]).removeData("ZebraDialog_MuteESC")):1===n&&a.hasClass("ZebraDialog_NoScroll")&&(a.removeClass("ZebraDialog_NoScroll").css({right:"",top:"",height:""}),D(window).scrollTop(a.data("ZebraDialog_vScroll"))),m.backdrop.off("click").animate({opacity:"0"},o,function(){m.backdrop.remove()})),m.dialog.animate({top:"0",opacity:"0"},m.settings.animation_speed_hide,function(){m.dialog.remove(),m.settings.onClose&&"function"==typeof m.settings.onClose&&m.settings.onClose(undefined!==t?t:"",e)})},m.update=function(){clearTimeout(p),p=setTimeout(function(){y()},100)},m.init()}}(jQuery);