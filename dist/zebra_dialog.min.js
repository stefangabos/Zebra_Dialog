!function(k){"use strict";k.Zebra_Dialog=function(){var f,_,h={animation_speed_hide:250,animation_speed_show:0,auto_close:!(this.version="3.1.0"),auto_focus_button:!0,backdrop_close:!0,backdrop_opacity:".9",buttons:!0,center_buttons:!1,custom_class:!1,default_value:"",disable_page_scrolling:!0,draggable:!0,height:0,keyboard:!0,margin:0,max_height:0,max_width:450,message:"",modal:!0,placeholder:"",position:"center",prompt_rows:1,reposition_speed:500,show_close_button:!0,source:!1,title:"",type:"information",vcenter_short_message:!0,width:0,onOpen:null,onBeforeClose:null,onClose:null},y=this,D={},v=!1,Z=!1,w=function(){var t,e=k(window).width(),o=k(window).height(),s=y.dialog.outerWidth(),i=y.dialog.outerHeight(),a=e<768,n=0,l=0;y.dialog_left=undefined,y.dialog_top=undefined,t={left:n=(t=(y.settings.margin+"").match(/^([0-9]+)(\%)?$/))&&(undefined!==t[2]?(n=parseInt(e*parseInt(t[1],10)/100,10),l=parseInt(o*parseInt(t[1],10)/100,10)):n=l=parseInt(t[1],10),isNaN(n))?l=0:n,top:l,right:e-n-s,bottom:o-l-i,center:(e-s)/2,middle:(o-i)/2},k.isArray(y.settings.position)&&2===y.settings.position.length&&"string"==typeof y.settings.position[0]&&y.settings.position[0].match(/^(left|right|center)[\s0-9\+\-]*$/)&&"string"==typeof y.settings.position[1]&&y.settings.position[1].match(/^(top|bottom|middle|center)[\s0-9\+\-]*$/)&&(y.settings.position[0]=y.settings.position[0].toLowerCase(),y.settings.position[1]=y.settings.position[1].toLowerCase(),"center"===y.settings.position[1]&&(y.settings.position[1]="middle"),k.each(t,function(t,e){for(var o,s,i=0;i<2;i++)(o=(s=a?y.settings.position[i].replace(/[0-9\+\-\s]/g,""):y.settings.position[i]).replace(t,e))!==s&&(0===i?y.dialog_left=r(o):y.dialog_top=r(o))})),undefined!==y.dialog_left&&undefined!==y.dialog_top||(y.dialog_left=t.center,y.dialog_top=t.middle),y.dialog_top<l&&(y.dialog_top=l),o-2*l<i+l?y.body.css("height",o-2*l-(k(".ZebraDialog_Title",y.dialog).length?k(".ZebraDialog_Title",y.dialog).outerHeight():0)-(k(".ZebraDialog_Buttons",y.dialog).length?k(".ZebraDialog_Buttons",y.dialog).outerHeight():0)-(parseFloat(y.body.css("marginTop"))||0)-(parseFloat(y.body.css("marginBottom"))||0)-(parseFloat(y.body.css("paddingTop"))||0)-(parseFloat(y.body.css("paddingBottom"))||0)-(parseFloat(y.body.css("borderTopWidth"))||0)-(parseFloat(y.body.css("borderBottomWidth"))||0)):Z&&y.body.css("height",y.dialog.height()-(k(".ZebraDialog_Title",y.dialog).length?k(".ZebraDialog_Title",y.dialog).outerHeight():0)-(k(".ZebraDialog_Buttons",y.dialog).length?k(".ZebraDialog_Buttons",y.dialog).outerHeight():0)-(parseFloat(y.body.css("marginTop"))||0)-(parseFloat(y.body.css("marginBottom"))||0)-(parseFloat(y.body.css("paddingTop"))||0)-(parseFloat(y.body.css("paddingBottom"))||0)-(parseFloat(y.body.css("borderTopWidth"))||0)-(parseFloat(y.body.css("borderBottomWidth"))||0)),y.iframe&&y.body.css("overflow","hidden"),y.settings.vcenter_short_message&&(e=(n=y.body.find("div:first")).height())<(s=y.body.height())&&n.css("padding-top",(s-e)/2),"boolean"==typeof arguments[0]&&!1===arguments[0]||0===y.settings.reposition_speed?y.dialog.css({left:y.dialog_left,top:y.dialog_top,visibility:"visible",opacity:0}).animate({opacity:"1"},y.settings.animation_speed_show):(y.dialog.stop(!0),y.dialog.css("visibility","visible").animate({left:y.dialog_left,top:y.dialog_top},y.settings.reposition_speed)),y.settings.onOpen&&"function"==typeof y.settings.onOpen&&y.settings.onOpen(y.dialog),undefined===f&&(!1!==y.settings.auto_focus_button?y.dialog.find("a[class^=ZebraDialog_Button]").eq(!0===y.settings.auto_focus_button?0:y.settings.auto_focus_button).focus():y.body.attr("tabindex",1).focus().removeAttr("tabindex"))},T=function(){switch(y.settings.type){case"confirmation":case"error":case"information":case"question":case"warning":case"prompt":return y.settings.type.charAt(0).toUpperCase()+y.settings.type.slice(1).toLowerCase();default:return!1}},r=function(t){var e=0;for(t=t.replace(/\s/g,"").match(/[+\-]?([0-9\.\s]+)/g)||[];t.length;)e+=parseFloat(t.shift());return e};return y.settings={},"string"==typeof arguments[0]&&(D.message=arguments[0]),"object"!=typeof arguments[0]&&"object"!=typeof arguments[1]||(D=k.extend(D,"object"==typeof arguments[0]?arguments[0]:arguments[1])),y.init=function(){var e,o,t,s,i,a,n,l,r,g,d,c,p,u,b=k("body"),m=0;if(y.settings=k.extend({},h,D),k(".ZebraDialog").each(function(){var t=parseInt(k(this).css("zIndex"),10);t&&m<t&&(m=t)}),y.settings.modal&&(y.backdrop=k("<div>",{"class":"ZebraDialogBackdrop"+(y.settings.custom_class?" "+y.settings.custom_class:"")}).css({position:"fixed",left:0,top:0,opacity:y.settings.backdrop_opacity+""}),0<m&&(y.backdrop.css("zIndex",m+1),k(".ZebraDialogBackdrop").each(function(){var t=k(this);t.data("ZebraDialog_opacity")||t.data("ZebraDialog_opacity",t.css("opacity")).css("opacity",0)}),k(".ZebraDialog").each(function(){k(this).data("ZebraDialog_MuteESC",!0)})),y.settings.backdrop_close&&y.backdrop.on("click",function(){y.close()}),y.backdrop.appendTo(b),y.settings.disable_page_scrolling)&&window.innerHeight<document.body.clientHeight&&!b.hasClass("ZebraDialog_NoScroll")&&b.data("ZebraDialog_vScroll",window.pageYOffset).css({right:(l=k("<div>").css({visibility:"hidden",overflow:"scroll",msOverflowStyle:"scrollbar"}).appendTo(k("body")),r=k("<div>").appendTo(l),u=l.outerWidth()-r.outerWidth(),l.remove(),r.remove(),u),top:-1*k(window).scrollTop()}).addClass("ZebraDialog_NoScroll"),y.dialog=k("<div>",{"class":"ZebraDialog"+(y.settings.custom_class?" "+y.settings.custom_class:"")+(y.settings.modal?"":" ZebraDialog_NotModal")+(!1!==T()?" ZebraDialog_Icon ZebraDialog_"+T():"")}).css({position:"fixed",left:0,top:0,visibility:"hidden"}),0<m&&y.dialog.css("zIndex",m+1),_=Math.floor(9999999*Math.random()),(l=(y.settings.width+"").match(/^([0-9]+)(\%)?$/))&&(l=undefined!==l[2]?parseInt(Math.max(document.documentElement.clientWidth,window.innerWidth||0)*parseInt(l[1],10)/100,10):parseInt(l[1],10),!isNaN(l))&&0<l&&y.dialog.css("width",l),(isNaN(l)||0===l)&&(l=(y.settings.max_width+"").match(/^([0-9]+)(\%)?$/))&&(l=undefined!==l[2]?parseInt(Math.max(document.documentElement.clientWidth,window.innerWidth||0)*parseInt(l[1],10)/100,10):parseInt(l[1],10),!isNaN(l))&&0<l&&y.dialog.css("max-width",l),(l=(y.settings.height+"").match(/^([0-9]+)(\%)?$/))&&(l=undefined!==l[2]?parseInt(Math.max(document.documentElement.clientHeight,window.innerHeight||0)*parseInt(l[1],10)/100,10):parseInt(l[1],10),!isNaN(l))&&0<l&&(y.dialog.css("height",l),Z=!0),(isNaN(l)||0===l)&&(l=(y.settings.max_height+"").match(/^([0-9]+)(\%)?$/))&&(l=undefined!==l[2]?parseInt(Math.max(document.documentElement.clientHeight,window.innerHeight||0)*parseInt(l[1],10)/100,10):parseInt(l[1],10),!isNaN(l))&&0<l&&(y.dialog.css("max-height",l),Z=!0),y.settings.title?a=k("<h3>",{"class":"ZebraDialog_Title"}).html(y.settings.title).appendTo(y.dialog):y.dialog.addClass("ZebraDialog_NoTitle"),undefined!==y.settings.source.iframe&&(y.settings.vcenter_short_message=!1),y.body=k("<div>",{"class":"ZebraDialog_Body"}),"prompt"===y.settings.type&&(1===parseInt(y.settings.prompt_rows,10)?y.settings.message+='<input name="ZebraDialog_Prompt_Input" value="'+y.settings.default_value+'"'+(""!==y.settings.placeholder.trim()?' placeholder="'+y.settings.placeholder+'"':"")+' class="ZebraDialog_Prompt_Input">':y.settings.message+='<textarea rows="'+(y.settings.prompt_rows||1)+'" name="ZebraDialog_Prompt_Input"'+(""!==y.settings.placeholder.trim()?' placeholder="'+y.settings.placeholder+'"':"")+' class="ZebraDialog_Prompt_Input">'+y.settings.default_value+"</textarea>"),y.settings.vcenter_short_message?k("<div>").html(y.settings.message).appendTo(y.body):y.body.html(y.settings.message),"prompt"===y.settings.type&&(y.settings.message=k(".ZebraDialog_Prompt_Input",y.body),k(".ZebraDialog_Prompt_Input",y.body).on("keypress",function(t){13!==t.keyCode||k(this).is("textarea")&&!t.shiftKey||(v?v.trigger("click"):y.close(!0,this.value))})),y.settings.source&&"object"==typeof y.settings.source)for(n in o=y.settings.vcenter_short_message?k("div:first",y.body):y.body,y.settings.source)switch(n){case"ajax":t="string"==typeof y.settings.source[n]?{url:y.settings.source[n]}:y.settings.source[n],i=k("<div>").attr("class","ZebraDialog_Spinner").appendTo(o),t.success=function(t){i.remove(),o.append(t),w(!1)},k.ajax(t);break;case"iframe":t=k.extend({width:"100%",height:"100%",marginheight:"0",marginwidth:"0",frameborder:"0"},"string"==typeof y.settings.source[n]?{src:y.settings.source[n]}:y.settings.source[n]),y.iframe=k("<iframe>").attr(t).on("load",function(){k(".ZebraDialog_Spinner",y.body).remove()}),y.body.append(k("<div>").addClass("ZebraDialog_Spinner ZebraDialog_iFrame")),o.append(y.iframe);break;case"inline":o.append(y.settings.source[n])}return y.body.appendTo(y.dialog),(r=function(){if(!0!==y.settings.buttons&&!k.isArray(y.settings.buttons))return!1;if(!0===y.settings.buttons)switch(y.settings.type){case"question":case"warning":case"prompt":y.settings.buttons=["Ok","Cancel"];break;default:y.settings.buttons=["Ok"]}return y.settings.buttons}())?(e=k("<div>",{"class":"ZebraDialog_Buttons"}).appendTo(y.dialog),k.each(r,function(t,o){t=k("<a>",{href:"javascript:void(0)","class":"ZebraDialog_Button_"+t+(undefined!==o.custom_class&&""!==o.custom_class.toString().trim()?" "+o.custom_class:"")});undefined!==o.caption?t.html(o.caption):t.html(o),t.on("click",function(){var t=!0,e="prompt"===y.settings.type&&k(".ZebraDialog_Prompt_Input",y.body).length?k(".ZebraDialog_Prompt_Input",y.body).val():undefined;!1!==(t=undefined!==o.callback?o.callback(y.dialog,e):t)&&y.close(undefined!==o.caption?o.caption:o,e)}),t.appendTo(e),undefined!==o.default_confirmation&&o.default_confirmation&&(v=t)}),y.settings.center_buttons&&e.addClass("ZebraDialog_Buttons_Centered")):y.dialog.addClass("ZebraDialog_NoButtons"),y.dialog.appendTo(b),y.settings.show_close_button?k('<a href="javascript:void(0)" class="ZebraDialog_Close">&times;</a>').on("click",function(t){t.preventDefault(),y.close()}).appendTo(a||y.body):y.dialog.addClass("ZebraDialog_NoCloseButton"),p=c=d=g=0,u=k(".ZebraDialog_Title",y.dialog),b=y.dialog,b="force"===y.settings.draggable&&0===u.length?b:u,y.settings.draggable&&(b.addClass("ZebraDialog_Draggable"),b.on({mousedown:function(t){var e,a,n;y.dialog.hasClass("ZebraDialog_Dragging")||(e=k(document),a=k(window).width(),n=k(window).height(),t.preventDefault(),y.dialog.addClass("ZebraDialog_Dragging"),g=t.clientX,d=t.clientY,e.on({"mousemove.ZebraDialog_Drag":function(t){var e=y.dialog.get(0),o=e.offsetLeft,s=e.offsetTop,i=e.offsetWidth,e=e.offsetHeight;c=g-t.clientX,p=d-t.clientY,g=t.clientX,d=t.clientY,o-c<0&&(c=o=0),s-p<0&&(p=s=0),a<o+i-c&&(o=a-i,c=0),n<s+e-p&&(s=n-e,p=0),y.dialog.css({left:o-c,top:s-p})},"mouseup.ZebraDialog_Drag":function(){y.dialog.removeClass("ZebraDialog_Dragging"),e.off("mousemove.ZebraDialog_Drag"),e.off("mouseup.ZebraDialog_Drag")}}))}})),k(window).on("resize.ZebraDialog_"+_,function(){clearTimeout(f),f=setTimeout(function(){w()},100)}),y.settings.keyboard&&k(document).on("keyup.ZebraDialog_"+_,function(t){if(!y.dialog.data("ZebraDialog_MuteESC"))return 27===t.which&&y.close(),!0}),!1!==y.settings.auto_close&&(y.dialog.on("click",function(){clearTimeout(y.timeout),y.close()}),y.timeout=setTimeout(y.close,y.settings.auto_close)),w(!1),"prompt"===y.settings.type&&(k(".ZebraDialog_Prompt_Input",y.body).focus(),""!==y.settings.default_value)&&(y.settings.message.get(0).setSelectionRange?(s=2*y.settings.default_value.length,setTimeout(function(){y.settings.message.get(0).setSelectionRange(s,s)},1)):y.settings.message.val(y.settings.default_value)),y},y.close=function(t,e){var o,s=y.settings.animation_speed_hide,i=k(".ZebraDialogBackdrop"),a=k(".ZebraDialog"),n=k("body"),l=i.length;y.settings.onBeforeClose&&"function"==typeof y.settings.onBeforeClose&&(o=y.settings.onBeforeClose(undefined!==t?t:"",e),undefined!==o)&&!o||(k(document).off(".ZebraDialog_"+_),k(window).off(".ZebraDialog_"+_),y.settings.modal&&y.backdrop&&(1<l&&k(i[l-1]).is(y.backdrop)?((o=k(i[l-2])).css("opacity",o.data("ZebraDialog_opacity")).removeData("ZebraDialog_opacity"),s=0,k(a[l-2]).removeData("ZebraDialog_MuteESC")):1===l&&n.hasClass("ZebraDialog_NoScroll")&&(n.removeClass("ZebraDialog_NoScroll").css({right:"",top:"",height:""}),k(window).scrollTop(n.data("ZebraDialog_vScroll"))),y.backdrop.off("click").animate({opacity:"0"},s,function(){y.backdrop.remove()})),y.dialog.animate({top:"0",opacity:"0"},y.settings.animation_speed_hide,function(){y.dialog.remove(),y.settings.onClose&&"function"==typeof y.settings.onClose&&y.settings.onClose(undefined!==t?t:"",e)}))},y.update=function(){clearTimeout(f),f=setTimeout(function(){w()},100)},y.init()}}(jQuery);